# shell编码规范(Draft)

## 命名

使用有含义的单词命名，

### 文件

全部使用小写的英文字符，扩展名为<mark>.sh</mark>, 单词之间使用"-"连接，如<i>install-pip.sh</i>

### 全局变量

定义在所有函数之外且不用关键字<mark>local</mark>修饰的变量，即为全局变量。

* 使用大写字母，单词间使用下划线<mark>_</mark>连接；

* 统一在脚本开头或结尾处声明；

* 定义后不修改的以<mark>readonly</mark>修饰

### 局部变量

定义在函数内且使用关键字<mark>local</mark>修饰的变量，即为局部变量如：<i>local install_package</i>。

* 使用小写字母，单词间使用下划线<mark>_</mark>连接；

* 尽量使用局部变量代替全局变量。

### 函数

* 函数名表面函数的用途或功能；

* 使用小写字母，单词间使用下划线<mark>_</mark>连接；

_同样的命名规则使用在局部变量上，由于局部变量均在函数内部，因此不必担心名称冲突。_


## 格式

### 注释

#### 用途

* 解释文件用途，版本等

* 解释全局变量含义

* 解释函数入参和返回参数

#### 约定

* 函数用途优先使用有含义的命名规则，而非使用注释解释其功能，如

```
# input: download_url,save_file_path
function download_package(){
    local download_url = "$1"
    ...

}
```

* 存在阅读障碍的代码增加注释解释。

### 函数/模块

* 专一性，一个函数只做一件事；

* 避免代码冗余/重复代码

* 代码行数控制在50~100行；

* 尽量不在函数内直接使用全局变量

_提高代码块的可移植性，避免重复自己的工作_

### 其他

* 使用<i>$(...)</i>代替<i>\`...\`</i>执行动态代码；

* if-else 嵌套使用case代替；

* 考虑是否需要在代码执行失败跳出`set -e`


